labels = seq(1, max(metadat$Duration) + 1, 1),
name = "Study Duration (years)"
) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
guides(fill = EcoTitle, colour = EcoTitle) +
theme(legend.position = "bottom")
ggplot(
data = metadat_ipreds,
aes(Duration, 100*(10^pred-1))
) +
geom_hline(yintercept = 0) +
geom_jitter(aes(fill = Ecosystem_type,
colour = Ecosystem_type),
na.rm = TRUE) +
geom_smooth(method = lm, formula = y ~ x, aes(fill = Ecosystem_type, color = Ecosystem_type)) +
ylab(units) +
scale_x_continuous(
breaks = seq(0, max(metadat$Duration), 1),
labels = seq(1, max(metadat$Duration) + 1, 1),
name = "Study Duration (years)"
) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
guides(fill = EcoTitle, colour = EcoTitle)
ggplot(
data = metadat_ipreds,
aes(Duration, 100*(10^pred-1))
) +
geom_hline(yintercept = 0) +
geom_jitter(aes(fill = Ecosystem_type,
colour = Ecosystem_type),
na.rm = TRUE) +
geom_smooth(method = lm, formula = y ~ x, aes(fill = Ecosystem_type, color = Ecosystem_type)) +
ylab("Percent Change") +
scale_x_continuous(
breaks = seq(0, max(metadat$Duration), 1),
labels = seq(1, max(metadat$Duration) + 1, 1),
name = "Study Duration (years)"
) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
guides(fill = EcoTitle, colour = EcoTitle)
setwd("C:/Users/morr497/OneDrive - PNNL/Documents/methane/")
EK_meth <- read.csv("EK_methane.csv")
str(EK_meth)
str(EK_meth)
unique(EK_meth$Unit)
mean(-1.25, -0.75, -1.3)
sd(-1.25, -0.75, -1.3)
values <- c("-1.25", "-0.75", "-1.3")
values
mean(values)
values <- c(-1.25, -0.75, -1.3)
values
mean(values)
sd(values)
values <- c(-1.2, -1.25, -1.3)
mean(values)
sd(values)
values <- c(-1.2, -1.1, -1.3)
sd(values)
mean(values)
values <- c(-0.3,-0.3,0.75)
mean(values)
sd(values)
values <- c(-0.05,0.25,0.2)
mean(values)
sd(values)
values <- c(0,-0.25,-0.3)
mean(values)
sd(values)
EK_meth <- read.csv("EK_methane.csv")
head(EK_meth)
unique(EK_meth$Unit)
View(EK_meth)
str(EK_meth)
#first annual measurements
# divided by 365, times 10^2 (kg to mg, plus ha to m2)
EK_meth %>%
select(Unit == "kg CH4 ha") %>%
mutate(CH4_control == CH4_control/3.65,
SD_CH4_control ==  SD_CH4_control/3.65,
SE_CH4_control == SE_CH4_control/3.65,
CH4_manip == CH4_manip/3.65,
SD_CH4_manip ==  SD_CH4_manip/3.65,
SE_CH4_manip == SE_CH4_manip/3.65)
EK_meth$Unit
#first annual measurements
# divided by 365, times 10^2 (kg to mg, plus ha to m2)
EK_meth %>%
select(Unit == "kg CH4 ha") %>%
mutate(CH4_control == CH4_control/3.65,
SD_CH4_control ==  SD_CH4_control/3.65,
SE_CH4_control == SE_CH4_control/3.65,
CH4_manip == CH4_manip/3.65,
SD_CH4_manip ==  SD_CH4_manip/3.65,
SE_CH4_manip == SE_CH4_manip/3.65)
#first annual measurements
# divided by 365, times 10^2 (kg to mg, plus ha to m2)
EK_meth %>%
filter(Unit == "kg CH4 ha") %>%
mutate(CH4_control == CH4_control/3.65,
SD_CH4_control ==  SD_CH4_control/3.65,
SE_CH4_control == SE_CH4_control/3.65,
CH4_manip == CH4_manip/3.65,
SD_CH4_manip ==  SD_CH4_manip/3.65,
SE_CH4_manip == SE_CH4_manip/3.65)
View(EK_meth)
#first annual measurements
# divided by 365, times 10^2 (kg to mg, plus ha to m2)
EK_meth %>%
filter(Unit == "kg CH4 ha") %>%
mutate(CH4_control == CH4_control/3.65,
SD_CH4_control ==  SD_CH4_control/3.65,
SE_CH4_control == SE_CH4_control/3.65,
CH4_manip == CH4_manip/3.65,
SD_CH4_manip ==  SD_CH4_manip/3.65,
SE_CH4_manip == SE_CH4_manip/3.65) -> EK_meth
View(EK_meth)
EK_meth <- read.csv("EK_methane.csv")
View(EK_meth)
library(dplyr)
#first annual measurements
# divided by 365, times 10^2 (kg to mg, plus ha to m2)
EK_meth %>%
filter(Unit == "kg CH4 ha") %>%
mutate(CH4_control == CH4_control/3.65,
SD_CH4_control ==  SD_CH4_control/3.65,
SE_CH4_control == SE_CH4_control/3.65,
CH4_manip == CH4_manip/3.65,
SD_CH4_manip ==  SD_CH4_manip/3.65,
SE_CH4_manip == SE_CH4_manip/3.65) -> EK_meth
EK_meth <- read.csv("EK_methane.csv")
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
#first annual measurements
# divided by 365, times 10^2 (kg to mg, plus ha to m2)
EK_meth %>%
filter(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control/3.65,
SD_CH4_control =  SD_CH4_control/3.65,
SE_CH4_control = SE_CH4_control/3.65,
CH4_manip = CH4_manip/3.65,
SD_CH4_manip =  SD_CH4_manip/3.65,
SE_CH4_manip = SE_CH4_manip/3.65) -> EK_meth
#first annual measurements
# divided by 365, times 10^2 (kg to mg, plus ha to m2)
EK_meth %>%
select(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control/3.65,
SD_CH4_control =  SD_CH4_control/3.65,
SE_CH4_control = SE_CH4_control/3.65,
CH4_manip = CH4_manip/3.65,
SD_CH4_manip =  SD_CH4_manip/3.65,
SE_CH4_manip = SE_CH4_manip/3.65) -> EK_meth
EK_meth <- read.csv("EK_methane.csv")
#first annual measurements
# divided by 365, times 10^2 (kg to mg, plus ha to m2)
EK_meth %>%
select(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control/3.65,
SD_CH4_control =  SD_CH4_control/3.65,
SE_CH4_control = SE_CH4_control/3.65,
CH4_manip = CH4_manip/3.65,
SD_CH4_manip =  SD_CH4_manip/3.65,
SE_CH4_manip = SE_CH4_manip/3.65) -> EK_meth
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
select(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65)
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
select(Unit = "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65)
EK_meth <- read.csv("EK_methane.csv")
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
select(Unit = "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65)
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
select(Unit = "kg CH4 ha") %>%
transmutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65)
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
select(Unit = "kg CH4 ha") %>%
transmute(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65)
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
select(Unit == "kg CH4 ha") %>%
transmute(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65)
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
filter(Unit == "kg CH4 ha") %>%
transmute(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65)
View(EK_meth)
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
filter(Unit == "kg CH4 ha") %>%
transmute(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65) -> EK_meth
View(EK_meth)
EK_meth <- read.csv("EK_methane.csv")
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
filter(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65) #-> EK_meth
View(EK_meth)
?replace
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
filter(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65) -> EK_meth
View(EK_meth)
EK_meth <- read.csv("EK_methane.csv")
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
group_by(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65) -> EK_meth
View(EK_meth)
EK_meth <- read.csv("EK_methane.csv")
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
group_by(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65,
Unit == "mg CH4 m2 d")
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
group_by(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65,
Unit = "mg CH4 m2 d")
EK_meth <- read.csv("EK_methane.csv")
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
group_by(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65,
Unit = "mg CH4 m2 d")
View(EK_meth)
#first annual measurements
# divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
group_by(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65,
Unit = "mg CH4 m2 d") -> EK_meth
View(EK_meth)
16.04/12.01
16.04/12.01 * 1000
16.04/12.01 * 1000 * 24
?rma.mv
res_irrigation
metadat_imodel
# rma.mv conducts a meta-analysis multivariate mixed effects model
# the - 1 for the fixed effect modifiers gives us estimates for individual ecosystem types
metadat_imodel <- rma.mv(yi, vi,
random = ~ 1 | Study_number,
mods = ~ Ecosystem_type * Duration + sg_ocs - 1,
method = "REML",
data = metadat_i,
slab = Ecosystem_type,
)
metadat_imodel
res_drought <- rma.mv(yi, vi,
random = ~ 1 | Study_number,
mods = ~ Ecosystem_type + sg_clay + sg_ocs + Percent_control - 1,
method = "ML",
data = metadat,
subset = Manipulation == "Drought"
)
res_drought
#this works just fine
metadat_dmodel2 <- rma.mv(yi, vi,
random = ~ 1 | Study_number,
mods = ~ Ecosystem_type * Duration + sg_ocs - 1,
method = "ML",
data = metadat,
subset = Manipulation == "Drought"
)
metadat_dmodel2
res_drought <- rma.mv(yi, vi,
random = ~ 1 | Study_number,
mods = ~ Ecosystem_type + sg_clay + sg_ocs + Percent_control - 1,
method = "REML",
data = metadat,
subset = Manipulation == "Drought"
)
res_drought
ggplot(metadat, aes(SM_mean, yi)) +
geom_point(aes(color = Ecosystem_type)) +
facet_grid(Manipulation~.) +
geom_smooth(method = "lm") +
scale_color_viridis_d()
metadat %>%
select("Study_number", "SM_mean", "Ecosystem_type",
"Duration", "sg_ocs", "yi",
"vi") %>%
na.omit() -> metadat_SM
units <- bquote('%Change ('*mu~ 'mol ' ~C~ m^-2~s^-1*')')
ggplot(
data = metadat_ipreds,
aes(Duration, 100*(10^pred-1))
) +
geom_hline(yintercept = 0) +
geom_jitter(aes(fill = Ecosystem_type,
colour = Ecosystem_type),
na.rm = TRUE) +
geom_smooth(method = lm, formula = y ~ x, aes(fill = Ecosystem_type, color = Ecosystem_type)) +
ylab("Percent Change") +
scale_x_continuous(
breaks = seq(0, max(metadat$Duration), 1),
labels = seq(1, max(metadat$Duration) + 1, 1),
name = "Study Duration (years)"
) +
scale_color_viridis_d() +
scale_fill_viridis_d() +
guides(fill = EcoTitle, colour = EcoTitle)
setwd("C:/Users/morr497/OneDrive - PNNL/Documents/methane/")
EK_meth <- read.csv("EK_methane.csv")
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
#first annual measurements
#divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
group_by(Unit == "kg CH4 ha") %>%
mutate(CH4_control = CH4_control / 3.65,
SD_CH4_control =  SD_CH4_control / 3.65,
SE_CH4_control = SE_CH4_control / 3.65,
CH4_manip = CH4_manip / 3.65,
SD_CH4_manip =  SD_CH4_manip / 3.65,
SE_CH4_manip = SE_CH4_manip / 3.65,
Unit = "mg CH4 m2 d") -> EK_meth
View(EK_meth)
cf <- c("kg CH4 ha" = 3.65,
"ug C m2 h" = 32053.29,
"mg CH4 m2 h" = 24,
"mg CH4 m2 d" = 1)
cf
cf["kg CH4 ha"]
cf[1]
EK_meth %>% mutate(cf = cf[Unit])
x <- EK_meth %>% mutate(cf = cf[Unit])
View(x)
cf[EK_meth$Unit]
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
setwd("C:/Users/morr497/OneDrive - PNNL/Documents/methane/")
EK_meth <- read.csv("EK_methane.csv")
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
cf <- c("kg CH4 ha" = 3.65,
"ug C m2 h" = 32053.29,
"mg CH4 m2 h" = 24,
"mg CH4 m2 d" = 1)
x <- EK_meth %>% mutate(cf = cf[Unit])
View(x)
1/3.65
setwd("C:/Users/morr497/OneDrive - PNNL/Documents/methane/")
EK_meth <- read.csv("EK_methane.csv")
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
#create conversion factors
con_fac <- c("kg CH4 ha" = 0.2739726,
"ug C m2 h" = 32053.29,
"mg CH4 m2 h" = 24,
"mg CH4 m2 d" = 1)
#first annual measurements
#divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
mutate(cf = con_fac[Unit],
CH4_control = CH4_control * cf,
SD_CH4_control =  SD_CH4_control * cf,
SE_CH4_control = SE_CH4_control * cf,
CH4_manip = CH4_manip * cf,
SD_CH4_manip =  SD_CH4_manip * cf,
SE_CH4_manip = SE_CH4_manip * cf,
Unit = "mg CH4 m2 d") -> EK_meth
View(EK_meth)
16.04/12.04
16.04/12.04 / 1000
(16.04/12.04) / 1000 * 24
EK_meth <- read.csv("EK_methane.csv")
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
#create conversion factors
con_fac <- c("kg CH4 ha" = 0.2739726,
"ug C m2 h" = 0.03197342,
"mg CH4 m2 h" = 24,
"mg CH4 m2 d" = 1)
#first annual measurements
#divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
mutate(cf = con_fac[Unit],
CH4_control = CH4_control * cf,
SD_CH4_control =  SD_CH4_control * cf,
SE_CH4_control = SE_CH4_control * cf,
CH4_manip = CH4_manip * cf,
SD_CH4_manip =  SD_CH4_manip * cf,
SE_CH4_manip = SE_CH4_manip * cf,
Unit = "mg CH4 m2 d") -> EK_meth
View(EK_meth)
EK_meth <- read.csv("EK_methane.csv")
#need to convert all values to common units of mg CH4 m2 d
unique(EK_meth$Unit)
#create conversion factors
con_fac <- c("kg CH4 ha" = 0.2739726,
"ug C m2 h" = 0.03197342,
"mg CH4 m2 h" = 24,
"mg CH4 m2 d" = 1)
#first annual measurements
#divided by 365, times 10^2 (kg to mg (10^6), plus ha to m2 (10^-4))
EK_meth %>%
mutate(cf = con_fac[Unit],
CH4_control = CH4_control * cf,
SD_CH4_control =  SD_CH4_control * cf,
SE_CH4_control = SE_CH4_control * cf,
CH4_manip = CH4_manip * cf,
SD_CH4_manip =  SD_CH4_manip * cf,
SE_CH4_manip = SE_CH4_manip * cf,
Unit = "mg CH4 m2 d") -> EK_meth
View(EK_meth)
